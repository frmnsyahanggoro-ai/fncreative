<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>McD Promo Injector</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #f4f4f4; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; max-width: 400px; }
        .card { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; }
        .btn { background: #da291c; color: white; border: none; padding: 12px; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; }
        h3 { font-size: 14px; margin: 0; height: 35px; overflow: hidden; }
    </style>
</head>
<body>

    <img src="https://www.mcdonalds.co.id/assets/img/common/mcdonalds_logo.png" width="50" style="margin-bottom: 20px;">
    <div class="grid" id="menu"></div>

<script>
    const promos = [
        { name: "Panas 1", off: "267611", loy: "5272" },
        { name: "Cheeseburger + FF", off: "272395", loy: "5271" },
        { name: "Ayam + McFloat + FF", off: "272400", loy: "5271" },
        { name: "McFlurry + FF", off: "272404", loy: "5271" },
        { name: "4 Pcs McNugget + Cola", off: "272469", loy: "5271" },
        { name: "Ayam + Nasi + Tea", off: "272484", loy: "5271" }
    ];

    const container = document.getElementById('menu');
    promos.forEach(p => {
        container.innerHTML += `
            <div class="card">
                <h3>${p.name}</h3>
                <button class="btn" onclick="injectVoucher('${p.off}', '${p.loy}')">INJECT</button>
            </div>
        `;
    });

    function injectVoucher(offId, loyId) {
        const slug = "2le1hb5pjyoo9"; 
        const mCode = "PaketNgemil12"; // Pastikan ini kode terbaru
        const partner = "Tiktok Live 109.5";

        // TEKNIK FORCED VIEW: 
        // Kita tambahkan parameter 'view=claim' dan 'action=redeem' 
        // agar aplikasi tidak hanya menampilkan info, tapi langsung memicu fungsi klaim.
        const targetUrl = `https://www.mcdonalds.co.id/offers/details?offer_id=${offId}&loyalty_id=${loyId}&code=${mCode}&is_mass_code=1&partner=${encodeURIComponent(partner)}&view=claim&action=redeem&force_open=1`;

        // Susun Deep Link dengan Full Parameter
        const deepLink = `gmalite://gmalite-smartweb?weburl=${encodeURIComponent(targetUrl)}`;

        // Eksekusi (Untuk iOS)
        const a = document.createElement('a');
        a.href = deepLink;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        // Backup: Jika banner muncul tapi tombol 'Tukar' tidak ada, gunakan skema REDEEM NATIVE
        setTimeout(() => {
            if (!document.hidden) {
                const nativeRedeem = `gmalite://offers/redeem?offer_id=${offId}&loyalty_id=${loyId}&code=${mCode}`;
                window.location.href = nativeRedeem;
            }
        }, 1200);
    }
</script>
</body>
</html>
